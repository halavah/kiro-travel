# 部署平台对比分析（2025 年免费方案）

> **适用场景**：演示项目、个人学习、白嫖免费部署
>
> **项目特点**：Next.js 16 + SQLite (better-sqlite3)
>
> **更新时间**：2025-12-15

---

## 📊 核心结论速览

| 平台 | 推荐指数 | 是否永久免费 | SQLite 原生支持 | 部署难度 | 核心限制 |
|------|---------|------------|----------------|---------|---------|
| **Render.com** | ⭐⭐⭐⭐⭐ | ✅ Web 服务永久免费 | ✅ 完全支持 | 极简单 | 15 分钟无访问自动休眠 |
| **Vercel + Turso** | ⭐⭐⭐⭐ | ✅ 两者都永久免费 | ⚠️ 需迁移到 Turso | 中等 | 需修改数据库代码 |
| **Cloudflare Pages + D1** | ⭐⭐⭐⭐ | ✅ 永久免费 | ⚠️ 需迁移到 D1 | 中等 | 需修改数据库代码 |
| **Fly.io** | ⭐⭐⭐ | ❌ 2024 年 10 月起不再免费 | ✅ 完全支持 | 复杂（需 Docker） | 新用户必须付费 |
| **Railway** | ⭐⭐ | ❌ $5 试用后需付费 | ✅ 完全支持 | 简单 | 试用结束后 $1/月起 |
| **Vercel 单独部署** | ❌ | ✅ 永久免费 | ❌ 完全不支持 | 简单 | 无法使用 SQLite |
| **Netlify** | ❌ | ✅ 永久免费 | ❌ 完全不支持 | 简单 | 无法使用 SQLite |

---

## 🎯 针对你的项目推荐

### 方案一：Render.com（强烈推荐）✨

**适合场景**：演示项目、个人作品展示、低流量应用

#### ✅ 优点
- **零代码修改**：直接支持 better-sqlite3，数据库代码完全不用改
- **完全免费**：Web 服务永久免费，无需信用卡
- **部署超简单**：连接 GitHub 仓库，自动部署
- **功能完整**：
  - 自定义域名支持
  - 自动 HTTPS 证书
  - 拉取请求预览（Pull Request Previews）
  - 日志流、回滚功能
  - 商业使用允许

#### ⚠️ 缺点
- **自动休眠**：15 分钟无访问后服务休眠
- **冷启动**：休眠后首次访问需要 30-60 秒唤醒
- **数据库存储**：SQLite 文件存储在本地磁盘，重新部署会丢失数据（需配置持久化卷）

#### 💡 解决方案
- Render 提供免费的持久化磁盘（Persistent Disks），配置后数据不会丢失
- 对于演示项目，可以通过简单的 "Keep Alive" 服务避免休眠（如 UptimeRobot 免费监控）

#### 📈 免费额度详情
- **Web 服务**：750 小时/月（单实例可全天候运行）
- **带宽**：100 GB/月
- **构建时间**：无限制
- **数据库**：PostgreSQL 30 天免费试用（SQLite 不受此限制）

#### 📚 参考资料
- [Render 官方定价](https://render.com/pricing)
- [Render 免费部署文档](https://render.com/docs/free)
- [Render Free Tier 详细限制](https://www.freetiers.com/directory/render)

---

### 方案二：Vercel + Turso（次优选择）

**适合场景**：追求全球低延迟、愿意轻微修改代码

#### ✅ 优点
- **两者都永久免费**：
  - Vercel：免费托管 Next.js
  - Turso：免费数据库服务
- **性能最佳**：
  - Vercel 全球 CDN
  - Turso 边缘数据库（查询延迟 < 50ms）
- **无冷启动**：Serverless 函数即时响应
- **可扩展性强**：并发写入支持，自动多区域复制

#### ⚠️ 缺点
- **需要修改代码**：
  - 替换 better-sqlite3 为 @libsql/client
  - 修改数据库连接逻辑
  - 预计工作量：1-2 小时
- **学习成本**：需要了解 Turso SDK 和 libSQL

#### 📈 免费额度详情

**Vercel 免费额度**：
- 部署次数：无限制
- 带宽：100 GB/月
- 函数调用：100 GB-小时/月
- 边缘函数：100 万次请求/月

**Turso 免费额度（2025 年更新）**：
- 数据库数量：500 个
- 存储空间：5 GB
- 读取行数：5 亿行/月
- 写入行数：1000 万行/月

#### 🔄 迁移复杂度评估

**需要修改的文件**（示例）：
```typescript
// 之前：better-sqlite3
import Database from 'better-sqlite3';
const db = new Database('travel.db');

// 之后：Turso
import { createClient } from '@libsql/client';
const db = createClient({
  url: process.env.TURSO_DATABASE_URL!,
  authToken: process.env.TURSO_AUTH_TOKEN!
});
```

**SQL 语法兼容性**：95% 以上兼容，极少数边缘情况需要调整

#### 📚 参考资料
- [Turso 官网](https://turso.tech/)
- [Vercel Marketplace - Turso 集成](https://vercel.com/marketplace/tursocloud)
- [Turso 免费计划详情](https://turso.tech/blog/turso-cloud-debuts-the-new-developer-plan)

---

### 方案三：Cloudflare Pages + D1

**适合场景**：需要全球边缘部署、对 Cloudflare 生态熟悉

#### ✅ 优点
- **完全免费**：无任何隐藏费用
- **D1 数据库**：Cloudflare 的 SQLite 边缘数据库
- **全球边缘计算**：CDN + 边缘函数
- **无流量费用**：D1 无数据传输费用
- **每日重置额度**：每天 00:00 UTC 重置限额

#### ⚠️ 缺点
- **需要修改代码**：迁移到 D1 API
- **每日查询限制**：超出免费额度后当日查询失败（直到 UTC 00:00 重置）
- **Next.js 支持**：需要使用 @cloudflare/next-on-pages 适配器
- **调试复杂**：Cloudflare Workers 环境与 Node.js 有差异

#### 📈 免费额度详情
- **读取行数**：每日限额（具体数值需查看官方文档）
- **写入行数**：每日限额（具体数值需查看官方文档）
- **存储**：每个数据库最大 10 GB
- **数据库数量**：可创建数千个数据库

#### 📚 参考资���
- [Cloudflare D1 官方文档](https://developers.cloudflare.com/d1/)
- [D1 定价](https://developers.cloudflare.com/d1/platform/pricing/)
- [D1 限制](https://developers.cloudflare.com/d1/platform/limits/)

---

## ❌ 不推荐的方案

### Fly.io
- **原因**：2024 年 10 月起不再对新用户提供免费计划
- **现状**：按使用付费，最低约 $1-5/月
- **参考**：[Fly.io 定价](https://fly.io/docs/about/pricing/)

### Railway
- **原因**：免费额度仅为 $5 一次性试用
- **现状**：试用后需付费，最低 $1/月起
- **参考**：[Railway 定价变更](https://www.freetiers.com/blog/render-vs-railway-comparison)

### Vercel 单独部署
- **原因**：Serverless 架构，文件系统只读，完全不支持 SQLite
- **替代**：必须搭配 Turso/Postgres 等外部数据库

### Netlify
- **原因**：同 Vercel，Serverless 架构不支持 SQLite
- **替代**：必须使用外部数据库服务

---

## 🚀 详细部署对比表

### 1. 技术架构对比

| 平台 | 架构类型 | 文件系统 | 持久化存储 | SQLite 支持 |
|------|---------|---------|-----------|------------|
| Render.com | 类 VPS（容器） | 可读写 | ✅ 持久化磁盘 | ✅ better-sqlite3 可用 |
| Vercel | Serverless | 只读 | ❌ 无持久化 | ❌ 不支持 |
| Netlify | Serverless | 只读 | ❌ 无持久化 | ❌ 不支持 |
| Fly.io | 微虚拟机 | 可读写 | ✅ Volumes | ✅ better-sqlite3 可用 |
| Railway | 容器 | 可读写 | ✅ Volumes | ✅ better-sqlite3 可用 |
| Cloudflare Pages | Edge Workers | 只读 | ⚠️ KV/R2/D1 | ⚠️ 需用 D1 API |

### 2. Next.js 16 支持情况

| 平台 | Next.js 16 支持 | Turbopack 支持 | App Router 支持 | 已知问题 |
|------|----------------|----------------|----------------|---------|
| Render.com | ✅ 完整支持 | ✅ 支持 | ✅ 支持 | 无 |
| Vercel | ✅ 完整支持 | ✅ 官方支持 | ✅ 官方支持 | better-sqlite3 编译超时 |
| Netlify | ✅ 完整支持 | ✅ 支持 | ✅ 支持 | better-sqlite3 不可用 |
| Fly.io | ✅ 完整支持 | ✅ 支持 | ✅ 支持 | 需自行配置 Dockerfile |
| Railway | ✅ 完整支持 | ✅ 支持 | ✅ 支持 | 无 |
| Cloudflare Pages | ⚠️ 需适配器 | ⚠️ 部分支持 | ✅ 支持 | 需 @cloudflare/next-on-pages |

### 3. 免费额度详细对比

| 平台 | 计算资源 | 存储空间 | 带宽/流量 | 请求次数 | 构建时间 | 是否永久 |
|------|---------|---------|---------|---------|---------|---------|
| **Render.com** | 750 小时/月 | 持久化磁盘（需配置） | 100 GB/月 | 无限制 | 无限制 | ✅ 永久 |
| **Vercel** | 100 GB-小时/月 | 无持久化 | 100 GB/月 | 边缘函数 100 万次/月 | 6000 分钟/月 | ✅ 永久 |
| **Netlify** | 300 构建分钟/月 | 无持久化 | 100 GB/月 | 无限制 | 300 分钟/月 | ✅ 永久 |
| **Fly.io** | 不再免费 | 不再免费 | 不再免费 | 不再免费 | 按需计费 | ❌ 需付费 |
| **Railway** | $5 一次性 | 按使用计费 | 按使用计费 | 无限制 | 无限制 | ❌ 试用后付费 |
| **Cloudflare** | 每日重置 | 10 GB/数据库 | 无限制（无传输费） | 每日限额 | 500 次构建/月 | ✅ 永久 |

### 4. 数据库方案对比

| 平台 | 原生 SQLite | 推荐外部数据库 | 数据库免费额度 | 迁移成本 |
|------|-----------|--------------|--------------|---------|
| **Render.com** | ✅ 完全支持 | PostgreSQL（30 天试用） | SQLite 无限制使用 | ⭐ 零成本 |
| **Vercel** | ❌ 不支持 | Turso / Neon / Supabase | Turso: 5GB + 5 亿读/1000 万写 | ⭐⭐⭐ 中等 |
| **Netlify** | ❌ 不支持 | Turso / Neon / Supabase | 同上 | ⭐⭐⭐ 中等 |
| **Fly.io** | ✅ 完全支持 | PostgreSQL / LiteFS | 不再免费 | ⭐ 零成本 |
| **Railway** | ✅ 完全支持 | PostgreSQL / MySQL | 包含在付费计划中 | ⭐ 零成本 |
| **Cloudflare** | ⚠️ D1 API | D1 (内置) | 10 GB 存储 + 每日查询限额 | ⭐⭐⭐⭐ 较高 |

### 5. 性能表现对比

| 平台 | 冷启动时间 | 全球分发 | 数据库延迟 | 并发能力 | 适合场景 |
|------|----------|---------|----------|---------|---------|
| **Render.com** | 30-60 秒（休眠后） | ❌ 单区域 | < 1ms（本地） | 中等 | 演示项目、低流量应用 |
| **Vercel** | < 1 秒 | ✅ 全球 CDN | 需外部数据库 | 高 | 生产环境、高流量 |
| **Netlify** | < 1 秒 | ✅ 全球 CDN | 需外部数据库 | 高 | 生产环境、高流量 |
| **Fly.io** | < 5 秒 | ✅ 多区域 | < 1ms（本地） | 高 | 全球部署 |
| **Railway** | < 5 秒 | ❌ 单区域 | < 1ms（本地） | 高 | 小型生产项目 |
| **Cloudflare** | < 100ms | ✅ 全球边缘 | < 50ms（边缘） | 极高 | 全球边缘应用 |

### 6. 开发体验对比

| 平台 | 部署复杂度 | 配置文件 | CI/CD | 本地调试 | 日志查看 | 学习曲线 |
|------|----------|---------|-------|---------|---------|---------|
| **Render.com** | ⭐ 极简单 | render.yaml（可选） | ✅ Git 集成 | 完全一致 | ✅ 实时日志 | 极低 |
| **Vercel** | ⭐ 极简单 | vercel.json（可选） | ✅ GitHub 集成 | 需 vercel dev | ✅ 实时日志 | 低 |
| **Netlify** | ⭐ 极简单 | netlify.toml（可选） | ✅ Git 集成 | 需 netlify dev | ✅ 实时日志 | 低 |
| **Fly.io** | ⭐⭐⭐⭐ 复杂 | fly.toml + Dockerfile | ✅ fly deploy | 需 flyctl | ✅ fly logs | 高 |
| **Railway** | ⭐⭐ 简单 | railway.json（可选） | ✅ Git 集成 | 完全一致 | ✅ 实时日志 | 低 |
| **Cloudflare** | ⭐⭐⭐ 中等 | wrangler.toml | ✅ Wrangler CLI | 需 wrangler dev | ✅ Wrangler tail | 中等 |

---

## 🎬 最终推荐决策

### 针对你的需求（演示用、完全免费）

#### 🥇 首选：Render.com

**理由**：
1. ✅ **零代码修改** - 你的 better-sqlite3 代码完全不用改
2. ✅ **永久免费** - Web 服务不过期，不需要信用卡
3. ✅ **部署最简单** - 连接 GitHub，点击部署，5 分钟搞定
4. ✅ **演示足够用** - 虽然��休眠，但可通过免费监控服务保持唤醒

**唯一缺点**：15 分钟无访问自动休眠（冷启动 30-60 秒）

**解决方案**：
- 使用 [UptimeRobot](https://uptimerobot.com/)（免费）每 5 分钟 ping 一次你的网站，避免休眠
- 或者接受休眠：对于演示项目，首次访问等待 1 分钟完全可以接受

#### 🥈 备选：Vercel + Turso

**理由**：
1. ✅ 两者都永久免费
2. ✅ 无冷启动，访问速度快
3. ✅ 全球 CDN，演示效果更专业
4. ⚠️ 需要花 1-2 小时修改数据库代码

**适合场景**：
- 如果你愿意花点时间改代码，追求更好的演示效果
- 未来可能扩展为生产项目

#### 🥉 第三选择：Cloudflare Pages + D1

**理由**：
1. ✅ 完全免费，无任何隐藏费用
2. ✅ 全球边缘部署
3. ⚠️ 配置较复杂，需要适配器
4. ⚠️ 每日查询限额，超出后当日无法访问

**适合场景**：
- 对 Cloudflare 生态熟悉
- 愿意学习 Edge Workers

---

## 📝 部署成本估算

### 演示项目场景（流量预估）
- 每天访问：50-100 次
- 每月页面浏览量：1500-3000 PV
- 数据库查询：每访问 10-20 次查询
- 存储需求：< 1 GB

### 各平台实际成本

| 平台 | 月成本 | 年成本 | 备注 |
|------|-------|-------|------|
| **Render.com** | $0 | $0 | 完全免费，750 小时足够单实例运行 |
| **Vercel + Turso** | $0 | $0 | 两者免费额度都远超演示需求 |
| **Cloudflare Pages + D1** | $0 | $0 | 每日限额对演示项目足够 |
| **Fly.io** | ~$1.94/月 | ~$23/月 | 最低配置（1 个 shared-cpu-1x + 1GB 存储） |
| **Railway** | $1/月起 | $12/月起 | 试用后按使用量计费 |

---

## 🔧 快速上手指南

### Render.com 部署步骤

1. **注册账号**：访问 [render.com](https://render.com/)
2. **连接 GitHub**：授权 Render 访问你的仓库
3. **创建 Web Service**：
   - 选择你的 kiro-travel 仓库
   - Environment: Node
   - Build Command: `npm install && npm run build`
   - Start Command: `npm start`
4. **配置持久化磁盘**（重要！）：
   - 在 Dashboard 中添加 Disk
   - Mount Path: `/data`
   - 修改数据库路径为 `/data/travel.db`
5. **设置环境变量**：
   - 添加 `.env` 中的所有变量
   - `JWT_SECRET`、`NEXT_PUBLIC_APP_URL` 等
6. **部署**：点击 "Create Web Service"，等待构建完成

**预计时间**：10-15 分钟

### Vercel + Turso 部署步骤

1. **部署到 Vercel**：
   ```bash
   npx vercel --prod
   ```
2. **创建 Turso 数据库**：
   ```bash
   curl -sSfL https://get.tur.so/install.sh | bash
   turso auth signup
   turso db create kiro-travel
   turso db tokens create kiro-travel
   ```
3. **配置环境变量**：
   ```bash
   vercel env add TURSO_DATABASE_URL
   vercel env add TURSO_AUTH_TOKEN
   ```
4. **修改数据库代码**：
   - 替换 `better-sqlite3` 为 `@libsql/client`
   - 更新连接逻辑（详见迁移文档）
5. **重新部署**：
   ```bash
   vercel --prod
   ```

**预计时间**：1-2 小时（含代码修改）

---

## 📚 参考资料汇总

### 官方文档
- [Render 定价](https://render.com/pricing)
- [Render 免费部署文档](https://render.com/docs/free)
- [Turso 官网](https://turso.tech/)
- [Vercel Marketplace - Turso](https://vercel.com/marketplace/tursocloud)
- [Cloudflare D1 文档](https://developers.cloudflare.com/d1/)
- [Fly.io 定价](https://fly.io/docs/about/pricing/)

### 社区资源
- [Render vs Railway 对比](https://www.freetiers.com/blog/render-vs-railway-comparison)
- [Vercel 免费额度详解](https://www.freetiers.com/directory/vercel)
- [Cloudflare Pages 免费额度](https://www.freetiers.com/directory/cloudflare-pages)

---

## ❓ 常见问题

### Q1: Render.com 的休眠问题能完全解决吗？
**A**: 可以！使用免费的监控服务（如 UptimeRobot）每 5 分钟 ping 一次，就能保持服务一直运行。

### Q2: Turso 的免费额度够用吗？
**A**: 对于演示项目绰绰有余。5 亿读 + 1000 万写/月，相当于每天可以处理约 30 万次数据库查询。

### Q3: 为什么 Vercel 不支持 SQLite？
**A**: Vercel 采用 Serverless 架构，每次请求都在新的容器中执行，文件系统是只读的，无法写入 SQLite 文件。

### Q4: Render.com 数据会丢失吗？
**A**: 如果配置了持久化磁盘（Persistent Disks），数据不会丢失。即使服务休眠或重新部署，数据都会保留。

### Q5: 哪个平台最适合未来升级到付费？
**A**: Vercel 或 Render.com。两者都有非常平滑的付费升级路径，Vercel 适合高流量应用，Render 适合需要后台任务的应用。

---

## ⚠️ 安全警告：DDoS 攻击与流量费用保护

### 🚨 核心问题：被攻击后谁来付费？

**重要提示**：在使用免费部署平台时，如果网站遭受 DDoS 攻击或恶意流量刷量，可能会产生高额流量费用。**这些费用通常需要你来承担！**

### 各平台被攻击后的费用责任

| 平台 | 免费额度 | 超出免费额度后 | 是否自动计费 | 风险等级 |
|------|---------|--------------|------------|---------|
| **Render.com** | 100 GB/月 | 每 GB $0.10 | ⚠️ 是（需绑定信用卡后） | ⭐⭐ 中等 |
| **Vercel** | 100 GB/月 | 每 GB $0.40 | ⚠️ 是（需绑定信用卡后） | ⭐⭐⭐ 较高 |
| **Netlify** | 100 GB/月 | 每 GB $0.55 | ⚠️ 是（需绑定信用卡后） | ⭐⭐��� 较高 |
| **Cloudflare Pages** | 无限流量 | 无额外费用 | ✅ 否，完全免费 | ⭐ 极低 |
| **Fly.io** | 无免费额度 | 按使用计费 | ⚠️ 是 | ⭐⭐⭐⭐ 高 |
| **Railway** | 包含在付费计划 | 按使用计费 | ⚠️ 是 | ⭐⭐⭐ 较高 |

### 真实案例：被攻击可能产生的费用

#### 案例 1：小型 DDoS 攻击
- **攻击规模**：1 TB 流量（恶意爬虫、CC 攻击）
- **Vercel 费用**：(1000 GB - 100 GB) × $0.40 = **$360**
- **Netlify 费用**：(1000 GB - 100 GB) × $0.55 = **$495**
- **Render 费用**：(1000 GB - 100 GB) × $0.10 = **$90**
- **Cloudflare Pages**：**$0**（无限流量）

#### 案例 2：中型 DDoS 攻击
- **攻击规模**：10 TB 流量（持续攻击 1-2 天）
- **Vercel 费用**：约 **$4,000**
- **Netlify 费用**：约 **$5,495**
- **Render 费用**：约 **$1,000**
- **Cloudflare Pages**：**$0**（无限流量）

### 🛡️ 如何保护自己免受高额账单？

#### 方案一：使用 Cloudflare 作为前置代理（强烈推荐）

**核心原理**：Cloudflare 提供无限流量的免费 CDN + DDoS 保护，作为网站的第一道防线。

**配置步骤**：
```
你的域名 → Cloudflare DNS（免费）→ 后端服务器（Render/Vercel）
                ↓
         DDoS 攻击在此被拦截
```

**优势**：
- ✅ **完全免费**：Cloudflare 免费计划提供无限流量
- ✅ **自动 DDoS 保护**：拦截常见攻击（SYN Flood, UDP Flood, HTTP Flood）
- ✅ **速率限制**：可设置每 IP 访问频率上限
- ✅ **Bot 检测**：自动识别和拦截恶意爬虫
- ✅ **真实 IP 保护**：隐藏后端服务器 IP，防止直接攻击

**配置步骤（详细）**：

1. **注册 Cloudflare 并添加域名**
   ```bash
   # 1. 访问 https://www.cloudflare.com/
   # 2. 添加你的域名（如 example.com）
   # 3. Cloudflare 会扫描你的 DNS 记录
   ```

2. **修改域名 DNS 服务器**
   ```
   # 在你的域名注册商（如阿里云、GoDaddy）处修改 NS 记录：
   ns1.cloudflare.com
   ns2.cloudflare.com
   ```

3. **配置 DNS 记录**
   ```
   类型: A 或 CNAME
   名称: @ 或 www
   内容: 你的 Render/Vercel 服务器 IP 或域名
   代理状态: ✅ 已代理（橙色云朵图标）  # 关键！必须开启代理
   ```

4. **启用 DDoS 防护规则**
   ```
   前往 Cloudflare Dashboard → 安全性 → WAF

   推荐规则：
   - 质询评分 < 30 的访问（拦截明显的机器人）
   - 限制每 IP 每分钟最多 60 次请求
   - 启用"我遭受攻击"模式（紧急情况下使用）
   ```

5. **设置速率限制**
   ```
   前往：安全性 → WAF → 速率限制规则

   示例规则：
   - 如果 IP 每 10 秒请求超过 20 次 → 质询/拦截
   - 如果 IP 每分钟请求超过 100 次 → 拦截 1 小时
   ```

6. **启用 Bot Fight Mode**（免费计划可用）
   ```
   前往：安全性 → Bots
   启用"Bot Fight Mode" → 自动质询可疑流量
   ```

**成本**：完全免费（Cloudflare Free 计划）

---

#### 方案二：平台内置保护措施

**Render.com 保护措施**：
```yaml
# render.yaml 配置限流
services:
  - type: web
    name: kiro-travel
    # 添加限流中间件
    envVars:
      - key: RATE_LIMIT_ENABLED
        value: true
      - key: RATE_LIMIT_MAX_REQUESTS
        value: 100  # 每 IP 每分钟最多 100 次
```

**Vercel 保护措施**：
```javascript
// middleware.ts - Vercel Edge 函数限流
import { Ratelimit } from "@upstash/ratelimit";
import { Redis } from "@upstash/redis";

const ratelimit = new Ratelimit({
  redis: Redis.fromEnv(),
  limiter: Ratelimit.slidingWindow(10, "10 s"), // 每 10 秒最多 10 次请求
});

export async function middleware(request: Request) {
  const ip = request.headers.get("x-forwarded-for") ?? "127.0.0.1";
  const { success } = await ratelimit.limit(ip);

  if (!success) {
    return new Response("Too Many Requests", { status: 429 });
  }
}
```

**局限性**：
- ⚠️ 需要额外编写代码
- ⚠️ 仍然消耗你的服务器流量（攻击流量会计入账单）
- ⚠️ 对大规模 DDoS 无效（攻击流量已进入你的服务器）

---

#### 方案三：设置流量告警和费用上限

**Render.com 告警设置**：
```
Dashboard → Account Settings → Billing
- 设置月度预算上限（如 $10）
- 启用邮件告警：流量达到 80%/90%/100% 时通知
- 启用自动暂停：超出预算后自动暂停服务
```

**Vercel 告警设置**：
```
Dashboard → Settings → Billing → Usage Alerts
- 设置流量告警：50 GB / 75 GB / 90 GB
- 设置费用上限（需联系客服，Hobby 计划不支持）
```

**Netlify 告警设置**：
```
Dashboard → User Settings → Billing → Usage Alerts
- 设置带宽告警：50 GB / 75 GB / 90 GB
- 超出免费额度后服务自动暂停（默认行为）
```

**重要提示**：
- ⚠️ Vercel/Netlify 默认情况下，超出免费额度后不会自动计费（除非你绑定了信用卡）
- ✅ 如果未绑定信用卡，超出额度后服务会被暂停（这是好事！）
- ⚠️ 如果绑定了信用卡，可能会产生高额账单

---

#### 方案四：不绑定信用卡（最保守）

**策略**：只使用免费额度，不绑定任何支付方式

**各平台行为**：

| 平台 | 是否必须绑卡 | 超出免费额度后行为 |
|------|-----------|-----------------|
| **Render.com** | ❌ 不强制 | 服务自动暂停，不会产生费用 |
| **Vercel** | ❌ 不强制 | 部署被禁用，不会产生费用 |
| **Netlify** | ❌ 不强制 | 网站下线，不会产生费用 |
| **Cloudflare Pages** | ❌ 不强制 | 无限流量，永远不会产生费用 |
| **Fly.io** | ✅ 必须绑卡 | 自动扣费，可能产生高额账单 |
| **Railway** | ✅ 必须绑卡 | 自动扣费，可能产生高额账单 |

**推荐做法**：
1. ✅ 使用 Render/Vercel/Netlify，不绑定信用卡
2. ✅ 配合 Cloudflare 免费 CDN 使用
3. ✅ 定期检查流量使用情况（每周查看一次 Dashboard）

---

### 🎯 最佳安全实践总结

#### 最安全方案：Cloudflare Pages + D1（推荐演示项目）

**为什么最安全**：
- ✅ **无限流量**：Cloudflare 免费计划无流量限制
- ✅ **内置 DDoS 保护**：全球最大的 DDoS 防护网络之一
- ✅ **零账单风险**：永远不会产生额外费用
- ✅ **全球 CDN**：200+ 节点，速度快

**缺点**：需要迁移数据库到 D1（工作量约 2-3 小时）

---

#### 次优方案：Render.com + Cloudflare 代理（推荐零代码改动）

**配置步骤**：
1. 在 Render.com 部署应用（参考前面的配置）
2. 购买域名（如 [Namecheap](https://www.namecheap.com/)，约 $1/年的 .xyz 域名）
3. 添加域名到 Cloudflare（免费）
4. 在 Cloudflare 配置 DNS 指向 Render
5. 启用 Cloudflare 的"代理"模式（橙色云朵）

**成本**：
- Render: $0
- Cloudflare: $0
- 域名: $1-10/年（可选，也可用 Render 提供的免费子域名）

**保护效果**：
- ✅ 拦截 99% 的 DDoS 攻击流量
- ✅ 即使遭受攻击，Render 只会看到正常流量
- ✅ 100 GB 免费流量足够使用

---

#### 紧急情况应对措施

**如果发现异常流量（攻击进行中）**：

1. **立即启用 Cloudflare"我遭受攻击"模式**
   ```
   Cloudflare Dashboard → 概述 → 快速操作
   → 启用"我遭受攻击"模式

   效果：所有访问者需要通过 5 秒质询页面
   ```

2. **临时暂停 Render/Vercel 服务**
   ```
   Render Dashboard → 你的服务 → Settings
   → Suspend Service（暂停服务）

   效果：立即停止流量消耗，不会产生更多费用
   ```

3. **检查访问日志，找出攻击来源**
   ```
   Cloudflare → Analytics → Security
   → 查看被拦截的请求
   → 添加 IP/国家 黑名单
   ```

4. **联系平台客服**
   - Render: support@render.com
   - Vercel: vercel.com/support
   - 说明情况：遭受 DDoS 攻击，请求豁免异常流量费用
   - **重要**：大多数平台对首次遭受攻击的用户会酌情减免费用

---

### 💰 费用豁免：平台政策

| 平台 | 是否豁免 DDoS 攻击费用 | 政策说明 |
|------|---------------------|---------|
| **Cloudflare Pages** | ✅ 不适用 | 无限流量，不会产生费用 |
| **Render.com** | ⚠️ 视情况而定 | 首次攻击可能减免，需联系客服 |
| **Vercel** | ⚠️ 视情况而定 | 需提供攻击证据，客服评估后决定 |
| **Netlify** | ⚠️ 视情况而定 | 官方政策：不主动豁免，但可以申诉 |

**重要提示**：
- ⚠️ **不要依赖平台豁免**：不保证每次都能减免
- ✅ **最佳做法**：提前配置 Cloudflare 保护
- ✅ **备用方案**：不绑定信用卡，超出免费额度后自动暂停服务

---

### 🔍 如何监控和检测异常流量

#### 1. 使用 Cloudflare Analytics（免费）
```
Cloudflare Dashboard → Analytics → Traffic
- 查看每日/每小时流量趋势
- 识别异常流量峰值
- 查看请求来源国家/地区
```

#### 2. 设置自定义告警（使用 UptimeRobot）
```
UptimeRobot → 创建监控
- 监控类型：HTTP(s)
- 告警条件：响应时间 > 5 秒（可能正在遭受攻击）
- 告警方式：邮件 + Telegram
```

#### 3. 检查平台 Dashboard
```
Render/Vercel Dashboard → 每周检查一次
- 查看流量使用量（是否接近 100 GB）
- 查看请求数趋势（是否突然暴增）
- 查看响应时间（是否变慢）
```

---

## 🎯 总结

**对于你的需求（演示用、完全免费），强烈推荐 Render.com + Cloudflare 组合**：

✅ 零代码修改
✅ 永久免费
✅ 部署最简单
✅ SQLite 完全支持
✅ **DDoS 保护（通过 Cloudflare）**
✅ **零账单风险（不绑定信用卡）**
⚠️ 唯一缺点：自动休眠（可通过免费监控解决）

**安全建议**：
1. ✅ 不绑定信用卡（超出免费额度后自动暂停，不会产生费用）
2. ✅ 使用 Cloudflare 免费 CDN 作为前置代理（可选但强烈推荐）
3. ✅ 设置流量告警（达到 80 GB 时邮件通知）
4. ✅ 每周检查一次 Dashboard（确保没有异常流量）

**如果预算允许（推荐方案）**：
- 购买便宜域名（$1-5/年）+ Cloudflare 免费 CDN
- 成本：约 ￥10/年
- 获得：完整的 DDoS 保护 + 更快的访问速度

**下一步行动**：
1. 我可以为你生成 Render.com 的配置文件（`render.yaml`）
2. 我可以写一份 Cloudflare 配置指南（详细截图步骤）
3. 或者如果你选择最安全的 Cloudflare Pages + D1，我可以帮你迁移数据库代码

你想选择哪个方案？我立即开始配置！
