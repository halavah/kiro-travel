# Docker éƒ¨ç½²æŒ‡å—

> **é€‚ç”¨é¡¹ç›®**ï¼škiro-travel Next.js 16 + SQLite
>
> **éƒ¨ç½²æ–¹å¼**ï¼šDocker å®¹å™¨åŒ–éƒ¨ç½²
>
> **é€‚ç”¨åœºæ™¯**ï¼šè‡ªæœ‰æœåŠ¡å™¨ã€VPSã€äº‘æœåŠ¡å™¨
>
> **æŠ€æœ¯æ ˆ**ï¼šDocker, Docker Compose, Next.js 16, Node.js 20, SQLite

---

## ğŸ“‹ ç›®ï¿½ï¿½

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ä¸ºä»€ä¹ˆä½¿ç”¨ Docker](#ä¸ºä»€ä¹ˆä½¿ç”¨-docker)
- [Docker éƒ¨ç½²ä¼˜åŠ¿](#docker-éƒ¨ç½²ä¼˜åŠ¿)
- [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
- [Docker é…ç½®](#docker-é…ç½®)
- [æœ¬åœ° Docker éƒ¨ç½²](#æœ¬åœ°-docker-éƒ¨ç½²)
- [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
- [æ•°æ®æŒä¹…åŒ–](#æ•°æ®æŒä¹…åŒ–)
- [Docker Compose éƒ¨ç½²](#docker-compose-éƒ¨ç½²)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¿«é€Ÿå¼€å§‹

å¦‚æœä½ åªæ˜¯æƒ³å¿«é€Ÿå¯åŠ¨é¡¹ç›®ï¼Œè·Ÿç€è¿™ä¸ª 3 æ­¥èµ°ï¼š

### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†æˆ–è¿›å…¥é¡¹ç›®ç›®å½•
cd /Volumes/Samsung/software_yare/kiro-travel

# 2. å¯åŠ¨å®¹å™¨ï¼ˆé¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨æ„å»ºé•œåƒï¼‰
docker-compose up -d

# 3. åˆå§‹åŒ–æ•°æ®åº“
docker-compose exec app npm run db:init

# 4. è®¿é—®åº”ç”¨
# æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000
```

### ä½¿ç”¨ Docker å‘½ä»¤

```bash
# 1. æ„å»ºé•œåƒ
docker build -t kiro-travel .

# 2. è¿è¡Œå®¹å™¨
docker run -d \
  -p 3000:3000 \
  -v kiro-travel-data:/app/data \
  -e JWT_SECRET=change-this-secret-key \
  --name kiro-travel \
  kiro-travel

# 3. åˆå§‹åŒ–æ•°æ®åº“
docker exec kiro-travel npm run db:init

# 4. è®¿é—®åº”ç”¨
# æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000
```

### å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps
# æˆ–
docker ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
# æˆ–
docker logs -f kiro-travel

# åœæ­¢å®¹å™¨
docker-compose down
# æˆ–
docker stop kiro-travel

# é‡å¯å®¹å™¨
docker-compose restart
# æˆ–
docker restart kiro-travel
```

---

## ä¸ºä»€ä¹ˆä½¿ç”¨ Dockerï¼Ÿ

### Docker vs å…¶ä»–éƒ¨ç½²æ–¹å¼

| éƒ¨ç½²æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| **Render.com** | å®Œå…¨å…è´¹ã€é›¶é…ç½® | è‡ªåŠ¨ä¼‘çœ ã€èµ„æºé™åˆ¶ | æ¼”ç¤ºé¡¹ç›®ã€åŸå‹ |
| **Docker** | å®Œå…¨æ§åˆ¶ã€é«˜æ€§èƒ½ã€ç¨³å®š | éœ€è¦æœåŠ¡å™¨ã€éœ€è¦é…ç½® | ç”Ÿäº§ç¯å¢ƒã€è‡ªæœ‰æœåŠ¡å™¨ |
| **Vercel** | é›¶é…ç½®ã€å…¨çƒ CDN | ä¸æ”¯æŒ SQLite | éœ€è¦å¤–éƒ¨æ•°æ®åº“çš„é¡¹ç›® |

### Docker é€‚åˆä½ çš„åœºæ™¯

âœ… é€‚åˆä½¿ç”¨ Dockerï¼š
- æœ‰è‡ªå·±çš„ VPS æˆ–äº‘æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€AWS ç­‰ï¼‰
- éœ€è¦å®Œå…¨æ§åˆ¶éƒ¨ç½²ç¯å¢ƒ
- ä¸æƒ³å—å…è´¹å¹³å°é™åˆ¶ï¼ˆæ— ä¼‘çœ ã€æ— æµé‡é™åˆ¶ï¼‰
- éœ€è¦é«˜æ€§èƒ½å’Œç¨³å®šæ€§
- æƒ³å­¦ä¹  Docker å®¹å™¨åŒ–æŠ€æœ¯

âŒ ä¸é€‚åˆä½¿ç”¨ Dockerï¼š
- æ²¡æœ‰æœåŠ¡å™¨ï¼Œåªæƒ³å…è´¹ç™½å«– â†’ ä½¿ç”¨ [Render.com](./Renderéƒ¨ç½²å¿«é€ŸæŒ‡å—.md)
- ä¸æƒ³å­¦ä¹  Docker â†’ ä½¿ç”¨ Render.com æˆ– Vercel
- åªæ˜¯æ¼”ç¤ºé¡¹ç›® â†’ Render.com æ›´ç®€å•

---

## Docker éƒ¨ç½²ä¼˜åŠ¿

### 1. ç¯å¢ƒä¸€è‡´æ€§
```
å¼€å‘ç¯å¢ƒ = æµ‹è¯•ç¯å¢ƒ = ç”Ÿäº§ç¯å¢ƒ
```
- å‘Šåˆ« "åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘" çš„é—®é¢˜
- æ‰€æœ‰ä¾èµ–æ‰“åŒ…åœ¨é•œåƒä¸­
- è·¨å¹³å°éƒ¨ç½²ï¼ˆLinuxã€macOSã€Windowsï¼‰

### 2. å¿«é€Ÿéƒ¨ç½²
```bash
# ä¸€è¡Œå‘½ä»¤å¯åŠ¨
docker run -p 3000:3000 kiro-travel
```

### 3. èµ„æºéš”ç¦»
- æ¯ä¸ªå®¹å™¨ç‹¬ç«‹è¿è¡Œ
- ä¸å½±å“å®¿ä¸»æœºç¯å¢ƒ
- æ˜“äºæ‰©å±•å’Œå‡çº§

### 4. å®Œå…¨æ§åˆ¶
- æ— éœ€ä¾èµ–ç¬¬ä¸‰æ–¹å¹³å°
- æ— ä¼‘çœ ã€æ— é™åˆ¶
- è‡ªå®šä¹‰é…ç½®

---

## å‰ç½®è¦æ±‚

### 1. å®‰è£… Docker

#### macOS
```bash
# ä½¿ç”¨ Homebrew å®‰è£…
brew install --cask docker

# æˆ–ä¸‹è½½ Docker Desktop
# https://www.docker.com/products/docker-desktop
```

#### Windows
1. ä¸‹è½½ Docker Desktopï¼šhttps://www.docker.com/products/docker-desktop
2. è¿è¡Œå®‰è£…ç¨‹åº
3. é‡å¯ç”µè„‘

#### Linux (Ubuntu/Debian)
```bash
# å®‰è£… Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å¯åŠ¨ Docker
sudo systemctl start docker
sudo systemctl enable docker

# æ·»åŠ å½“å‰ç”¨æˆ·åˆ° docker ç»„ï¼ˆé¿å…æ¯æ¬¡ sudoï¼‰
sudo usermod -aG docker $USER
```

### 2. éªŒè¯å®‰è£…

```bash
# æ£€æŸ¥ Docker ç‰ˆæœ¬
docker --version
# Docker version 24.0.0, build xxx

# æµ‹è¯• Docker è¿è¡Œ
docker run hello-world
```

---

## Docker é…ç½®

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Dockerfile

é¡¹ç›®å·²ç»åŒ…å«äº† `Dockerfile`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```dockerfile
# ä½¿ç”¨ Node.js 20 Debian Slim é•œåƒï¼ˆbetter-sqlite3 å’Œ lightningcss éœ€è¦æ›´å¥½çš„åŸç”Ÿæ¨¡å—æ”¯æŒï¼‰
FROM node:20-slim AS base

# æ„å»ºé˜¶æ®µï¼ˆåˆå¹¶ä¾èµ–å®‰è£…å’Œæ„å»ºï¼Œç¡®ä¿åŸç”Ÿæ¨¡å—åœ¨æ­£ç¡®ç¯å¢ƒä¸­ç¼–è¯‘ï¼‰
FROM base AS builder
WORKDIR /app

# å®‰è£…ç¼–è¯‘å·¥å…·ï¼ˆbetter-sqlite3 å’Œ lightningcss éœ€è¦ï¼‰
RUN apt-get update && apt-get install -y \
    python3 \
    make \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ package.json å¹¶åœ¨æœ‰ç¼–è¯‘å·¥å…·çš„ç¯å¢ƒä¸­å®‰è£…ä¾èµ–
# è¿™ç¡®ä¿ lightningcss å®‰è£… linux-x64-gnu ç‰ˆæœ¬è€Œä¸æ˜¯ darwin-arm64
COPY package.json package-lock.json* ./
RUN npm ci

# å¤åˆ¶æºä»£ç 
COPY . .

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV NEXT_TELEMETRY_DISABLED=1
ENV NODE_ENV=production

# æ„å»º Next.js åº”ç”¨
RUN npm run build

# ç”Ÿäº§é˜¶æ®µ
FROM base AS runner
WORKDIR /app

# å®‰è£…è¿è¡Œæ—¶éœ€è¦çš„å·¥å…·ï¼ˆwget ç”¨äºå¥åº·æ£€æŸ¥ï¼‰
RUN apt-get update && apt-get install -y \
    wget \
    && rm -rf /var/lib/apt/lists/*

ENV NODE_ENV=production
ENV NEXT_TELEMETRY_DISABLED=1

# åˆ›å»ºé root ç”¨æˆ·ï¼ˆDebian è¯­æ³•ï¼‰
RUN groupadd -r -g 1001 nodejs && \
    useradd -r -u 1001 -g nodejs nextjs

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static
COPY --from=builder /app/scripts ./scripts
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json ./package.json

# åˆ›å»ºæ•°æ®ç›®å½•
RUN mkdir -p /app/data && chown nextjs:nodejs /app/data

# åˆ‡æ¢åˆ°é root ç”¨æˆ·
USER nextjs

# æš´éœ²ç«¯å£
EXPOSE 3000

ENV PORT=3000
ENV HOSTNAME="0.0.0.0"

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=40s --retries=3 \
  CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/health || exit 1

# å¯åŠ¨åº”ç”¨
CMD ["node", "server.js"]
```

**é‡è¦è¯´æ˜**ï¼š
- ä½¿ç”¨ `node:20-slim` è€Œä¸æ˜¯ `alpine`ï¼Œå› ä¸º `better-sqlite3` å’Œ `lightningcss` åœ¨ Debian ç¯å¢ƒä¸‹ç¼–è¯‘æ›´å¯é 
- å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒä½“ç§¯
- åŒ…å«å¥åº·æ£€æŸ¥åŠŸèƒ½
- ä»¥é root ç”¨æˆ·è¿è¡Œï¼Œæé«˜å®‰å…¨æ€§

### ç¬¬äºŒæ­¥ï¼šéªŒè¯ next.config.mjs

é¡¹ç›®å·²ç»é…ç½®äº† `output: 'standalone'`ï¼Œæ— éœ€ä¿®æ”¹ï¼š

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  // Docker éƒ¨ç½²æ”¯æŒï¼šå¯ç”¨ standalone æ¨¡å¼
  output: 'standalone',

  typescript: {
    ignoreBuildErrors: true,
  },
  images: {
    unoptimized: true,
  },
  // å‡å°‘è¾“å‡ºæ—¥å¿—ä»¥åŠ å¿«æ„å»º
  logging: {
    fetches: {
      fullUrl: false,
    },
  },
}

export default nextConfig
```

### ç¬¬ä¸‰æ­¥ï¼šç¯å¢ƒå˜é‡é…ç½®

é¡¹ç›®æ”¯æŒä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| ç¯å¢ƒå˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ | æ˜¯å¦å¿…éœ€ |
|---------|------|--------|---------|
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | `production` | æ˜¯ |
| `JWT_SECRET` | JWT åŠ å¯†å¯†é’¥ | `change-this-secret-key` | **å¼ºçƒˆå»ºè®®ä¿®æ”¹** |
| `NEXT_PUBLIC_APP_URL` | åº”ç”¨è®¿é—® URL | `http://localhost:3000` | ç”Ÿäº§ç¯å¢ƒå¿…éœ€ |
| `DATABASE_PATH` | SQLite æ•°æ®åº“è·¯å¾„ | `/app/data/database.sqlite` | å¦ |
| `PORT` | åº”ç”¨ç›‘å¬ç«¯å£ | `3000` | å¦ |
| `HOSTNAME` | åº”ç”¨ç›‘å¬åœ°å€ | `0.0.0.0` | å¦ |

**ç”Ÿæˆå®‰å…¨çš„ JWT_SECRET**ï¼š

```bash
# ä½¿ç”¨ openssl ç”Ÿæˆéšæœºå¯†é’¥
openssl rand -hex 32

# æˆ–ä½¿ç”¨ Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

### ç¬¬å››æ­¥ï¼šåˆ›å»º .dockerignore

é¡¹ç›®å·²åŒ…å« `.dockerignore` æ–‡ä»¶ï¼Œç”¨äºæ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶ï¼š

```
# ä¾èµ–
node_modules
.pnp
.pnp.js

# æµ‹è¯•
coverage

# Next.js
.next
out

# ç”Ÿäº§
build

# ç¯å¢ƒå˜é‡
.env*.local
.env

# è°ƒè¯•æ—¥å¿—
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# æ“ä½œç³»ç»Ÿ
.DS_Store
*.pem

# IDE
.vscode
.idea
*.swp
*.swo

# Git
.git
.gitignore

# æ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
data/*.db
data/*.sqlite
*.sqlite
*.sqlite3

# æ–‡æ¡£
docs
README.md

# å…¶ä»–
.vercel
```

---

## æœ¬åœ° Docker éƒ¨ç½²

### 1. æ„å»º Docker é•œåƒ

```bash
cd /Volumes/Samsung/software_yare/kiro-travel

# æ„å»ºé•œåƒï¼ˆéœ€è¦ 5-10 åˆ†é’Ÿï¼‰
docker build -t kiro-travel .

# æŸ¥çœ‹æ„å»ºçš„é•œåƒ
docker images
```

**é¢„æœŸè¾“å‡º**ï¼š
```
REPOSITORY      TAG       IMAGE ID       CREATED         SIZE
kiro-travel     latest    abc123def456   2 minutes ago   450MB
```

### 2. è¿è¡Œå®¹å™¨

```bash
# åŸºæœ¬è¿è¡Œ
docker run -p 3000:3000 kiro-travel

# åå°è¿è¡Œ
docker run -d -p 3000:3000 --name kiro-travel kiro-travel

# å¸¦ç¯å¢ƒå˜é‡è¿è¡Œ
docker run -d \
  -p 3000:3000 \
  -e JWT_SECRET=your-secret-key \
  -e NEXT_PUBLIC_APP_URL=http://localhost:3000 \
  --name kiro-travel \
  kiro-travel
```

### 3. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000

### 4. æŸ¥çœ‹å®¹å™¨çŠ¶æ€

```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨
docker ps

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs kiro-travel

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker logs -f kiro-travel

# è¿›å…¥å®¹å™¨ Shell
docker exec -it kiro-travel sh
```

### 5. åœæ­¢å’Œåˆ é™¤å®¹å™¨

```bash
# åœæ­¢å®¹å™¨
docker stop kiro-travel

# å¯åŠ¨å®¹å™¨
docker start kiro-travel

# åˆ é™¤å®¹å™¨
docker rm kiro-travel

# åˆ é™¤é•œåƒ
docker rmi kiro-travel
```

---

## æ•°æ®æŒä¹…åŒ–

### é—®é¢˜ï¼šå®¹å™¨åˆ é™¤åæ•°æ®ä¸¢å¤±

Docker å®¹å™¨æ˜¯ä¸´æ—¶çš„ï¼Œåˆ é™¤å®¹å™¨åæ•°æ®ä¼šä¸¢å¤±ã€‚éœ€è¦ä½¿ç”¨ **Docker Volumes** æŒä¹…åŒ–æ•°æ®ã€‚

### è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ Docker Volume

#### æ–¹æ³•ä¸€ï¼šå‘½åå·ï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºå‘½åå·
docker volume create kiro-travel-data

# è¿è¡Œå®¹å™¨å¹¶æŒ‚è½½å·
docker run -d \
  -p 3000:3000 \
  -v kiro-travel-data:/app/data \
  -e JWT_SECRET=your-secret-key \
  --name kiro-travel \
  kiro-travel

# æŸ¥ï¿½ï¿½ï¿½å·
docker volume ls

# æŸ¥çœ‹å·è¯¦æƒ…
docker volume inspect kiro-travel-data
```

#### æ–¹æ³•äºŒï¼šç»‘å®šæŒ‚è½½ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

```bash
# æŒ‚è½½æœ¬åœ°ç›®å½•åˆ°å®¹å™¨
docker run -d \
  -p 3000:3000 \
  -v $(pwd)/data:/app/data \
  -e JWT_SECRET=your-secret-key \
  --name kiro-travel \
  kiro-travel
```

### åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿›å…¥å®¹å™¨
docker exec -it kiro-travel sh

# åˆå§‹åŒ–æ•°æ®åº“
npm run db:init

# é€€å‡º
exit
```

### å¤‡ä»½å’Œæ¢å¤æ•°æ®

#### å¤‡ä»½æ•°æ®åº“

```bash
# å¤åˆ¶æ•°æ®åº“æ–‡ä»¶åˆ°æœ¬åœ°
docker cp kiro-travel:/app/data/database.sqlite ./backup-$(date +%Y%m%d).sqlite

# æˆ–è€…ä½¿ç”¨å·å¤‡ä»½
docker run --rm \
  -v kiro-travel-data:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/backup-$(date +%Y%m%d).tar.gz /data
```

#### æ¢å¤æ•°æ®åº“

```bash
# ä»æœ¬åœ°å¤åˆ¶åˆ°å®¹å™¨
docker cp ./backup-20251215.sqlite kiro-travel:/app/data/database.sqlite

# é‡å¯å®¹å™¨
docker restart kiro-travel
```

---

## å¥åº·æ£€æŸ¥

é¡¹ç›®åŒ…å«å†…ç½®çš„å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼Œç”¨äºç›‘æ§åº”ç”¨çŠ¶æ€ã€‚

### å¥åº·æ£€æŸ¥ API

**ç«¯ç‚¹**: `GET /api/health`

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "status": "ok",
  "timestamp": "2025-12-16T10:30:00.000Z",
  "database": "connected"
}
```

### Docker å¥åº·æ£€æŸ¥

Dockerfile å’Œ docker-compose.yml éƒ½é…ç½®äº†å¥åº·æ£€æŸ¥ï¼š

```dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=40s --retries=3 \
  CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/health || exit 1
```

**å‚æ•°è¯´æ˜**ï¼š
- `--interval=30s`: æ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡
- `--timeout=10s`: æ£€æŸ¥è¶…æ—¶æ—¶é—´ 10 ç§’
- `--start-period=40s`: å¯åŠ¨åç­‰å¾… 40 ç§’å†å¼€å§‹æ£€æŸ¥
- `--retries=3`: å¤±è´¥ 3 æ¬¡åæ ‡è®°ä¸º unhealthy

### æŸ¥çœ‹å¥åº·çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨å¥åº·çŠ¶æ€
docker ps
# CONTAINER ID   IMAGE         STATUS
# abc123         kiro-travel   Up 5 minutes (healthy)

# ä½¿ç”¨ docker inspect æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
docker inspect --format='{{json .State.Health}}' kiro-travel | jq

# æ‰‹åŠ¨æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹
curl http://localhost:3000/api/health
```

---

## Docker Compose éƒ¨ç½²

ä½¿ç”¨ Docker Compose ç®€åŒ–å®¹å™¨ç®¡ç†ï¼ˆæ¨èï¼‰ã€‚

### docker-compose.yml é…ç½®

é¡¹ç›®å·²åŒ…å« `docker-compose.yml` æ–‡ä»¶ï¼š

```yaml
version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: kiro-travel
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - JWT_SECRET=${JWT_SECRET:-change-this-secret-key}
      - NEXT_PUBLIC_APP_URL=${NEXT_PUBLIC_APP_URL:-http://localhost:3000}
      - DATABASE_PATH=/app/data/database.sqlite
    volumes:
      - kiro-travel-data:/app/data
    networks:
      - kiro-network
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

volumes:
  kiro-travel-data:
    driver: local

networks:
  kiro-network:
    driver: bridge
```

**é…ç½®è¯´æ˜**ï¼š
- `restart: unless-stopped`: å®¹å™¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯
- `healthcheck`: æ¯ 30 ç§’æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€
- å·æŒ‚è½½ç¡®ä¿æ•°æ®æŒä¹…åŒ–
- æ”¯æŒé€šè¿‡ `.env` æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡é…ç½®

### ä½¿ç”¨ Docker Compose

#### åŸºæœ¬å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡ï¼ˆé¦–æ¬¡ä¼šè‡ªåŠ¨æ„å»ºé•œåƒï¼‰
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—
docker-compose logs -f app

# åœæ­¢æœåŠ¡
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å·ï¼ˆè­¦å‘Šï¼šä¼šåˆ é™¤æ•°æ®ï¼ï¼‰
docker-compose down -v

# é‡å¯æœåŠ¡
docker-compose restart

# é‡æ–°æ„å»ºé•œåƒ
docker-compose build

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

#### åˆå§‹åŒ–æ•°æ®åº“

```bash
# æ–¹æ³•ä¸€ï¼šä½¿ç”¨ docker-compose exec
docker-compose exec app npm run db:init

# æ–¹æ³•äºŒï¼šä½¿ç”¨ docker exec
docker exec kiro-travel npm run db:init
```

#### æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨

```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºç»Ÿè®¡
docker-compose stats

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker-compose ps
```

#### æ›´æ–°åº”ç”¨

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç ï¼ˆå¦‚æœä½¿ç”¨ Gitï¼‰
git pull

# 2. é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# 3. æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å¯åŠ¨æˆåŠŸ
docker-compose logs -f
```

### ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶æ¥é…ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# åˆ›å»º .env æ–‡ä»¶
nano .env
```

`.env` æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š

```.env
# JWT åŠ å¯†å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿®æ”¹ï¼ï¼‰
JWT_SECRET=your-super-secret-jwt-key-here-please-change-this

# åº”ç”¨è®¿é—® URL
NEXT_PUBLIC_APP_URL=http://localhost:3000

# æ•°æ®åº“è·¯å¾„ï¼ˆé»˜è®¤å³å¯ï¼‰
DATABASE_PATH=/app/data/database.sqlite
```

**ç”Ÿæˆå®‰å…¨çš„ JWT_SECRET**ï¼š

```bash
# ä½¿ç”¨ openssl
openssl rand -hex 32

# æˆ–ä½¿ç”¨ Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

**æ³¨æ„**: ä¸è¦å°† `.env` æ–‡ä»¶æäº¤åˆ° Git ä»“åº“ï¼Œç¡®ä¿ `.gitignore` ä¸­å·²åŒ…å« `.env`ã€‚

### å®Œæ•´å¯åŠ¨æµç¨‹

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /Volumes/Samsung/software_yare/kiro-travel

# 2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œä½¿ç”¨é»˜è®¤å€¼ä¹Ÿå¯ä»¥ï¼‰
nano .env

# 3. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 4. ç­‰å¾…å®¹å™¨å¯åŠ¨ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰
docker-compose logs -f

# 5. åˆå§‹åŒ–æ•°æ®åº“
docker-compose exec app npm run db:init

# 6. è®¿é—®åº”ç”¨
# æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000

# 7. æŸ¥çœ‹å¥åº·çŠ¶æ€
curl http://localhost:3000/api/health
```

---

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### åœºæ™¯ä¸€ï¼šéƒ¨ç½²åˆ°é˜¿é‡Œäº‘ ECS

#### 1. å‡†å¤‡æœåŠ¡å™¨

```bash
# SSH è¿æ¥æœåŠ¡å™¨
ssh root@your-server-ip

# å®‰è£… Docker
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun

# å¯åŠ¨ Docker
systemctl start docker
systemctl enable docker
```

#### 2. ä¸Šä¼ é¡¹ç›®

```bash
# æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Git
git clone https://github.com/your-username/kiro-travel.git
cd kiro-travel

# æ–¹æ³•äºŒï¼šä½¿ç”¨ SCP
scp -r /Volumes/Samsung/software_yare/kiro-travel root@your-server-ip:/opt/
```

#### 3. æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t kiro-travel .

# è¿è¡Œå®¹å™¨
docker run -d \
  -p 80:3000 \
  -v kiro-travel-data:/app/data \
  -e JWT_SECRET=$(openssl rand -hex 32) \
  -e NEXT_PUBLIC_APP_URL=http://your-domain.com \
  --restart unless-stopped \
  --name kiro-travel \
  kiro-travel

# åˆå§‹åŒ–æ•°æ®åº“
docker exec kiro-travel npm run db:init
```

#### 4. é…ç½® Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

```nginx
# /etc/nginx/sites-available/kiro-travel
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

```bash
# å¯ç”¨ç«™ç‚¹
ln -s /etc/nginx/sites-available/kiro-travel /etc/nginx/sites-enabled/
nginx -t
systemctl reload nginx
```

### åœºæ™¯äºŒï¼šéƒ¨ç½²åˆ° Google Cloud Run

#### 1. å®‰è£… Google Cloud SDK

```bash
# macOS
brew install google-cloud-sdk

# ç™»å½•
gcloud auth login
```

#### 2. æ„å»ºå¹¶æ¨é€é•œåƒ

```bash
# åˆ›å»ºé¡¹ç›®
gcloud projects create kiro-travel-prod
gcloud config set project kiro-travel-prod

# å¯ç”¨ Cloud Build
gcloud services enable cloudbuild.googleapis.com
gcloud services enable run.googleapis.com

# æ„å»ºé•œåƒ
gcloud builds submit --tag gcr.io/kiro-travel-prod/kiro-travel

# éƒ¨ç½²åˆ° Cloud Run
gcloud run deploy kiro-travel \
  --image gcr.io/kiro-travel-prod/kiro-travel \
  --platform managed \
  --region asia-east1 \
  --allow-unauthenticated \
  --set-env-vars JWT_SECRET=your-secret,NEXT_PUBLIC_APP_URL=https://your-domain.com
```

### åœºæ™¯ä¸‰ï¼šä½¿ç”¨ Docker Hub åˆ†å‘é•œåƒ

#### 1. æ³¨å†Œ Docker Hub

è®¿é—® https://hub.docker.com/ æ³¨å†Œè´¦å·

#### 2. æ¨é€é•œåƒ

```bash
# ç™»å½•
docker login

# æ‰“æ ‡ç­¾
docker tag kiro-travel your-username/kiro-travel:latest

# æ¨é€
docker push your-username/kiro-travel:latest
```

#### 3. åœ¨å…¶ä»–æœåŠ¡å™¨æ‹‰å–

```bash
# æ‹‰å–é•œåƒ
docker pull your-username/kiro-travel:latest

# è¿è¡Œ
docker run -d -p 3000:3000 your-username/kiro-travel:latest
```

---

## å¸¸è§é—®é¢˜

### Q1: æ„å»ºå¤±è´¥ - better-sqlite3 æˆ– lightningcss ç¼–è¯‘é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: Cannot find module 'better-sqlite3'
Error: Cannot find module '@parcel/watcher'
```

**åŸå› **ï¼šè¿™äº›åŸç”Ÿæ¨¡å—éœ€è¦åœ¨ Linux ç¯å¢ƒä¸­ç¼–è¯‘ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
é¡¹ç›®å·²ä½¿ç”¨ `node:20-slim` é•œåƒå¹¶åœ¨æ„å»ºé˜¶æ®µå®‰è£…ç¼–è¯‘å·¥å…·ã€‚å¦‚æœä»æœ‰é—®é¢˜ï¼š

```bash
# æ¸…ç† Docker ç¼“å­˜é‡æ–°æ„å»º
docker-compose down
docker system prune -a
docker-compose build --no-cache
docker-compose up -d
```

### Q2: ç«¯å£ 3000 å·²è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: bind: address already in use
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ–¹æ³•ä¸€ï¼šä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£æ˜ å°„
# å°† "3000:3000" æ”¹ä¸º "8080:3000"
ports:
  - "8080:3000"

# æ–¹æ³•äºŒï¼šæ‰¾åˆ°å¹¶åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :3000
kill -9 <PID>
```

### Q3: æ•°æ®åº“æ–‡ä»¶æƒé™é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
EACCES: permission denied, open '/app/data/database.sqlite'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥å®¹å™¨å†…æƒé™
docker exec kiro-travel ls -la /app/data

# ä¿®å¤æƒé™
docker exec kiro-travel chown -R nextjs:nodejs /app/data

# æˆ–è€…é‡æ–°åˆ›å»ºå®¹å™¨
docker-compose down -v
docker-compose up -d
docker-compose exec app npm run db:init
```

### Q4: å¥åº·æ£€æŸ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š
```
docker ps æ˜¾ç¤º (unhealthy)
```

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker-compose logs -f app

# 2. æ‰‹åŠ¨æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹
curl http://localhost:3000/api/health

# 3. è¿›å…¥å®¹å™¨æ£€æŸ¥
docker exec -it kiro-travel sh
wget --spider http://localhost:3000/api/health

# 4. æŸ¥çœ‹å¥åº·æ£€æŸ¥è¯¦ç»†ä¿¡æ¯
docker inspect --format='{{json .State.Health}}' kiro-travel | jq
```

**å¸¸è§åŸå› **ï¼š
- åº”ç”¨å¯åŠ¨æ—¶é—´è¿‡é•¿ï¼ˆè°ƒæ•´ `start_period`ï¼‰
- æ•°æ®åº“æœªåˆå§‹åŒ–
- ç¯å¢ƒå˜é‡é…ç½®é”™è¯¯

### Q5: å®¹å™¨å¯åŠ¨åç«‹å³é€€å‡º

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# æŸ¥çœ‹é€€å‡ºçš„å®¹å™¨
docker ps -a

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs kiro-travel

# å¸¸è§åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š
```

**å¯èƒ½åŸå› **ï¼š
1. **æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨**ï¼šè¿è¡Œ `docker-compose exec app npm run db:init`
2. **ç¯å¢ƒå˜é‡é”™è¯¯**ï¼šæ£€æŸ¥ `.env` æ–‡ä»¶
3. **æ„å»ºå¤±è´¥**ï¼šé‡æ–°æ„å»º `docker-compose build --no-cache`

### Q6: å®¹å™¨å†…æ— æ³•è®¿é—®å¤–éƒ¨ç½‘ç»œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ Docker ç½‘ç»œ
docker network ls

# æ£€æŸ¥å®¹å™¨ç½‘ç»œé…ç½®
docker inspect kiro-travel | jq '.[0].NetworkSettings'

# é‡å»ºç½‘ç»œ
docker-compose down
docker network prune
docker-compose up -d
```

### Q7: é•œåƒä½“ç§¯å¤ªå¤§ï¼ˆ> 1GBï¼‰

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

é¡¹ç›®å·²ç»ä½¿ç”¨äº†å¤šé˜¶æ®µæ„å»ºï¼Œä½†å¦‚æœéœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š

```dockerfile
# åœ¨ Dockerfile çš„ builder é˜¶æ®µæ·»åŠ 
RUN npm ci --production=false \
  && npm run build \
  && npm prune --production \
  && npm cache clean --force
```

æŸ¥çœ‹é•œåƒå¤§å°ï¼š
```bash
docker images kiro-travel
```

### Q8: Docker Compose æ‰¾ä¸åˆ°

**é”™è¯¯ä¿¡æ¯**ï¼š
```
docker-compose: command not found
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# Docker Compose V2 (æ¨è)
docker compose version

# å¦‚æœæ˜¯æ–°ç‰ˆ Dockerï¼Œä½¿ç”¨ docker composeï¼ˆæœ‰ç©ºæ ¼ï¼‰
docker compose up -d

# æˆ–å®‰è£… docker-compose
# macOS
brew install docker-compose

# Linux
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### Q9: å¦‚ä½•æŸ¥çœ‹æ•°æ®åº“å†…å®¹ï¼Ÿ

```bash
# æ–¹æ³•ä¸€ï¼šè¿›å…¥å®¹å™¨ä½¿ç”¨ SQLite
docker exec -it kiro-travel sh
cd /app/data
sqlite3 database.sqlite
# SQLite å‘½ä»¤ï¼š
# .tables          - æŸ¥çœ‹æ‰€æœ‰è¡¨
# .schema users    - æŸ¥çœ‹è¡¨ç»“æ„
# SELECT * FROM users; - æŸ¥è¯¢æ•°æ®
# .quit            - é€€å‡º

# æ–¹æ³•äºŒï¼šå¤åˆ¶æ•°æ®åº“åˆ°æœ¬åœ°
docker cp kiro-travel:/app/data/database.sqlite ./database.sqlite
# ç„¶åä½¿ç”¨æœ¬åœ°çš„ SQLite å·¥å…·æˆ– DB Browser for SQLite æ‰“å¼€
```

### Q10: å¦‚ä½•åœ¨å®¹å™¨ä¸­è¿è¡Œå…¶ä»– npm è„šæœ¬ï¼Ÿ

```bash
# é‡ç½®æ•°æ®åº“
docker-compose exec app npm run db:reset

# è®¾ç½®å…¨æ–‡æœç´¢
docker-compose exec app npm run db:fts

# æŸ¥çœ‹ package.json ä¸­çš„æ‰€æœ‰è„šæœ¬
docker-compose exec app npm run
```

### Q11: Docker æ„å»ºé€Ÿåº¦å¾ˆæ…¢

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```bash
# 1. å¯ç”¨ BuildKitï¼ˆæ›´å¿«çš„æ„å»ºï¼‰
export DOCKER_BUILDKIT=1
docker-compose build

# 2. ä½¿ç”¨å›½å†…é•œåƒæºï¼ˆæ·»åŠ åˆ° Dockerfileï¼‰
# åœ¨ RUN npm ci ä¹‹å‰æ·»åŠ ï¼š
RUN npm config set registry https://registry.npmmirror.com

# 3. ä½¿ç”¨æ„å»ºç¼“å­˜
docker-compose build --build-arg BUILDKIT_INLINE_CACHE=1
```

### Q12: å¦‚ä½•æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µï¼Ÿ

```bash
# å®æ—¶æŸ¥çœ‹
docker stats kiro-travel

# æˆ–ä½¿ç”¨ docker-compose
docker-compose stats

# æŸ¥çœ‹è¯¦ç»†çš„å®¹å™¨ä¿¡æ¯
docker inspect kiro-travel

# æŸ¥çœ‹å®¹å™¨è¿›ç¨‹
docker top kiro-travel
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. å¯ç”¨ BuildKit

```bash
# å¯ç”¨ Docker BuildKitï¼ˆæ›´å¿«çš„æ„å»ºï¼‰
export DOCKER_BUILDKIT=1

# æ„å»º
docker build -t kiro-travel .
```

### 2. ä½¿ç”¨æ„å»ºç¼“å­˜

```bash
# ä½¿ç”¨ç¼“å­˜æ„å»º
docker build --cache-from kiro-travel:latest -t kiro-travel .
```

### 3. é™åˆ¶å®¹å™¨èµ„æº

```bash
# é™åˆ¶ CPU å’Œå†…å­˜
docker run -d \
  -p 3000:3000 \
  --cpus="1.0" \
  --memory="512m" \
  --name kiro-travel \
  kiro-travel
```

### 4. å¥åº·æ£€æŸ¥

åœ¨ Dockerfile ä¸­æ·»åŠ ï¼š

```dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=40s --retries=3 \
  CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/health || exit 1
```

---

## ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨

```bash
# å®æ—¶æŸ¥çœ‹
docker stats kiro-travel

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker stats
```

### æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œæ—¥å¿—
docker logs --tail 100 kiro-travel

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker logs -f kiro-travel

# æŸ¥çœ‹å¸¦æ—¶é—´æˆ³çš„æ—¥å¿—
docker logs -t kiro-travel

# å¯¼å‡ºæ—¥å¿—åˆ°æ–‡ä»¶
docker logs kiro-travel > kiro-travel.log
```

---

## å¯¹æ¯”ï¼šDocker vs Render.com

| ç‰¹æ€§ | Docker éƒ¨ç½² | Render.com |
|------|-----------|------------|
| **æˆæœ¬** | æœåŠ¡å™¨è´¹ç”¨ï¼ˆ$5-50/æœˆï¼‰ | å…è´¹ |
| **é…ç½®å¤æ‚åº¦** | ä¸­ç­‰ï¼ˆéœ€è¦å­¦ä¹  Dockerï¼‰ | æï¿½ï¿½ï¿½ï¼ˆé›¶é…ç½®ï¼‰ |
| **æ€§èƒ½** | ä¼˜ç§€ï¼ˆå®Œå…¨æ§åˆ¶ï¼‰ | è‰¯å¥½ï¼ˆå…±äº«èµ„æºï¼‰ |
| **è‡ªåŠ¨ä¼‘çœ ** | æ—  | 15 åˆ†é’Ÿæ— è®¿é—®ä¼‘çœ  |
| **èµ„æºé™åˆ¶** | æ ¹æ®æœåŠ¡å™¨é…ç½® | 750 å°æ—¶/æœˆ |
| **æ•°æ®æŒä¹…åŒ–** | å®Œå…¨æ§åˆ¶ | éœ€é…ç½®æŒä¹…åŒ–ç£ç›˜ |
| **æ‰©å±•æ€§** | é«˜ï¼ˆå®¹æ˜“æ‰©å±•ï¼‰ | æœ‰é™ |
| **å­¦ä¹ æ›²çº¿** | é™¡å³­ | å¹³ç¼“ |
| **é€‚ç”¨åœºæ™¯** | ç”Ÿäº§ç¯å¢ƒã€è‡ªæœ‰æœåŠ¡å™¨ | æ¼”ç¤ºé¡¹ç›®ã€åŸå‹ |

### æ¨èé€‰æ‹©

- **æ¼”ç¤ºé¡¹ç›®ã€å­¦ä¹ ç”¨é€”** â†’ [Render.com](./Renderéƒ¨ç½²å¿«é€ŸæŒ‡å—.md)
- **ç”Ÿäº§ç¯å¢ƒã€æœ‰æœåŠ¡å™¨** â†’ Docker éƒ¨ç½²
- **éœ€è¦å…¨çƒ CDNã€é«˜å¹¶å‘** â†’ Vercel + Turso

---

## ä¸‹ä¸€æ­¥

### 1. æœ¬åœ°æµ‹è¯•

```bash
# æ„å»ºé•œåƒ
docker build -t kiro-travel .

# è¿è¡Œå®¹å™¨
docker run -d -p 3000:3000 \
  -v kiro-travel-data:/app/data \
  --name kiro-travel \
  kiro-travel

# åˆå§‹åŒ–æ•°æ®åº“
docker exec kiro-travel npm run db:init

# è®¿é—® http://localhost:3000
```

### 2. ç”Ÿäº§éƒ¨ç½²

é€‰æ‹©éƒ¨ç½²æ–¹æ¡ˆï¼š
- é˜¿é‡Œäº‘ ECS / è…¾è®¯äº‘ CVM
- AWS EC2
- Google Cloud Run
- DigitalOcean Droplet

### 3. æŒç»­å­¦ä¹ 

- Docker å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.docker.com/
- Next.js Docker éƒ¨ç½²ï¼šhttps://nextjs.org/docs/deployment#docker-image
- Docker Composeï¼šhttps://docs.docker.com/compose/

---

## ç›¸å…³æ–‡æ¡£

- [Render éƒ¨ç½²å¿«é€ŸæŒ‡å—](./Renderéƒ¨ç½²å¿«é€ŸæŒ‡å—.md) - å…è´¹é›¶é…ç½®éƒ¨ç½²
- [éƒ¨ç½²å¹³å°å¯¹æ¯”åˆ†æ](./éƒ¨ç½²å¹³å°å¯¹æ¯”åˆ†æ.md) - é€‰æ‹©åˆé€‚çš„éƒ¨ç½²æ–¹æ¡ˆ
- [éƒ¨ç½²æ£€æŸ¥æ¸…å•](./éƒ¨ç½²æ£€æŸ¥æ¸…å•.md) - Render éƒ¨ç½²éªŒè¯

---

**æœ€åæ›´æ–°**ï¼š2025-12-16

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š2.0

**æ›´æ–°å†…å®¹**ï¼š
- æ·»åŠ å¿«é€Ÿå¯åŠ¨æŒ‡å—
- æ›´æ–°ä¸ºå®é™…çš„ node:20-slim Dockerfile é…ç½®
- å®Œå–„ç¯å¢ƒå˜é‡è¯´æ˜å’Œé…ç½®æ–¹æ³•
- æ·»åŠ å¥åº·æ£€æŸ¥ API ç«¯ç‚¹è¯´æ˜
- æ‰©å……å¸¸è§é—®é¢˜åˆ° 12 ä¸ªå®ç”¨åœºæ™¯
- æ·»åŠ  Docker Compose å®Œæ•´ä½¿ç”¨æµç¨‹
- å¢åŠ æ•°æ®åº“ç®¡ç†å’Œå®¹å™¨è°ƒè¯•æŠ€å·§
